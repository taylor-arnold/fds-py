<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taylor Arnold">

<title>2&nbsp; EDA I: Organizing Data – Foundations of Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_graphics.html" rel="next">
<link href="./01_intro.html" rel="prev">
<link href="./img/owl_explore.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-25064e4154141e7ea34817c6f1220590.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_intro.html">Part I: Core</a></li><li class="breadcrumb-item"><a href="./02_modify.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Organizing Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/taylor-arnold/fds-py" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Core</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_modify.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Organizing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">EDA II: Visualizing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_combine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">EDA III: Restructuring Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_collect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">EDA IV: Collecting Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Part II: Programming</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_dataformats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_requests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Requests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Part III: Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_supervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Supervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_unsupervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_deeplearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_cnnwordvec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">CNNs and Word2Vec</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_transferlearn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Transfer Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Part IV: Applications</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_spatial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Spatial Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_temporal_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Temporal Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_network_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Network Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_textual_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Textual Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_image_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Image Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Part V: Notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Notes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">2.1</span> Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2.2</span> Introduction</a></li>
  <li><a href="#sorting-rows" id="toc-sorting-rows" class="nav-link" data-scroll-target="#sorting-rows"><span class="header-section-number">2.3</span> Sorting Rows</a></li>
  <li><a href="#selecting-columns-1" id="toc-selecting-columns-1" class="nav-link" data-scroll-target="#selecting-columns-1"><span class="header-section-number">2.4</span> Selecting Columns</a></li>
  <li><a href="#selecting-rows" id="toc-selecting-rows" class="nav-link" data-scroll-target="#selecting-rows"><span class="header-section-number">2.5</span> Selecting Rows</a></li>
  <li><a href="#grouping-data" id="toc-grouping-data" class="nav-link" data-scroll-target="#grouping-data"><span class="header-section-number">2.6</span> Grouping Data</a></li>
  <li><a href="#adding-columns" id="toc-adding-columns" class="nav-link" data-scroll-target="#adding-columns"><span class="header-section-number">2.7</span> Adding Columns</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation"><span class="header-section-number">2.8</span> Aggregation</a></li>
  <li><a href="#pipes" id="toc-pipes" class="nav-link" data-scroll-target="#pipes"><span class="header-section-number">2.9</span> Pipes</a></li>
  <li><a href="#further-functions" id="toc-further-functions" class="nav-link" data-scroll-target="#further-functions"><span class="header-section-number">2.10</span> Further Functions</a></li>
  <li><a href="#rs-dplyr-and-python-pandas" id="toc-rs-dplyr-and-python-pandas" class="nav-link" data-scroll-target="#rs-dplyr-and-python-pandas"><span class="header-section-number">2.11</span> R’s dplyr and Python Pandas</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_intro.html">Part I: Core</a></li><li class="breadcrumb-item"><a href="./02_modify.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Organizing Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-organize" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">EDA I: Organizing Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice Notebooks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Notebook02a [<a href="https://colab.research.google.com/github/taylor-arnold/fds-py-nb/blob/main/nb/notebook02a.ipynb?hl=en">Colab↗</a>]</li>
<li>Notebook02b [<a href="https://colab.research.google.com/github/taylor-arnold/fds-py-nb/blob/main/nb/notebook02b.ipynb?hl=en">Colab↗</a>]</li>
<li>Notebook02c [<a href="https://colab.research.google.com/github/taylor-arnold/fds-py-nb/blob/main/nb/notebook02c.ipynb?hl=en">Colab↗</a>]</li>
<li>Notebook02d [<a href="https://colab.research.google.com/github/taylor-arnold/fds-py-nb/blob/main/nb/notebook02d.ipynb?hl=en">Colab↗</a>]</li>
</ul>
</div>
</div>
</div>
<section id="setup" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="setup"><span class="header-section-number">2.1</span> Setup</h2>
<p>We will begin this and every subsequent chapter by listing the core modules and datasets that must be loaded before getting started. Datasets and sources that require new functions will be loaded within the body of the text.</p>
<div id="ec4d02cf" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> funs <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> polars <span class="im">import</span> col <span class="im">as</span> c</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>theme_set(theme_minimal())</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>country <span class="op">=</span> pl.read_csv(<span class="st">"data/countries.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.2</span> Introduction</h2>
<p>We will use a variety of methods to modify our datasets. All data operations shown in this chapter come from the Polars library—the same one we used to read our data. These operations take a DataFrame as input and produce a modified DataFrame as output. This consistency makes it easy to chain operations and build complex data transformations step by step. The operations we learn in this chapter are fundamental building blocks for data analysis; while they may seem simple individually, they become powerful when combined.</p>
</section>
<section id="sorting-rows" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sorting-rows"><span class="header-section-number">2.3</span> Sorting Rows</h2>
<p>Organizing data in a meaningful order is often crucial for understanding patterns and trends. We’ll use the <code>.sort()</code> method to reorder the dataset by arranging rows according to one or more columns. This is particularly useful for identifying extreme values, understanding distributions, or preparing data for specific types of analysis. Let’s look at an example of sorting the countries dataset by population, then break down how it works.</p>
<div id="067c3070" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.pop)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"ISL"</td>
<td>"Iceland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>0.398</td>
<td>84.92</td>
<td>65.0</td>
<td>-19.0</td>
<td>0.972</td>
<td>67444</td>
<td>26.1</td>
<td>75.62</td>
<td>107.2</td>
<td>98.78217</td>
<td>"isl"</td>
</tr>
<tr class="even">
<td>"MLT"</td>
<td>"Malta"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.545</td>
<td>83.48</td>
<td>35.883333</td>
<td>14.5</td>
<td>0.924</td>
<td>63314</td>
<td>31.0</td>
<td>62.95</td>
<td>107.8</td>
<td>99.96455</td>
<td>"eng|mlt"</td>
</tr>
<tr class="odd">
<td>"MNE"</td>
<td>"Montenegro"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.633</td>
<td>76.92</td>
<td>42.766667</td>
<td>19.216667</td>
<td>0.862</td>
<td>29492</td>
<td>29.4</td>
<td>58.13</td>
<td>185.1</td>
<td>96.657</td>
<td>"cnr|cnr"</td>
</tr>
<tr class="even">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
<td>"fra|deu|ltz"</td>
</tr>
<tr class="odd">
<td>"COM"</td>
<td>"Comoros"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>0.883</td>
<td>70.26</td>
<td>-12.3</td>
<td>43.7</td>
<td>0.603</td>
<td>3718</td>
<td>45.3</td>
<td>35.88</td>
<td>25.2</td>
<td>35.85662</td>
<td>"ara|fra"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
<td>"eng|urd"</td>
</tr>
<tr class="even">
<td>"IDN"</td>
<td>"Indonesia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>285.721</td>
<td>72.25</td>
<td>-2.0</td>
<td>118.0</td>
<td>0.728</td>
<td>15391</td>
<td>37.9</td>
<td>56.95</td>
<td>85.8</td>
<td>77.51606</td>
<td>"ind"</td>
</tr>
<tr class="odd">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>"CHN"</td>
<td>"China"</td>
<td>"Asia"</td>
<td>"Eastern Asia"</td>
<td>1416.096</td>
<td>78.81</td>
<td>35.844722</td>
<td>103.451944</td>
<td>0.797</td>
<td>25505</td>
<td>38.2</td>
<td>61.45</td>
<td>63.6</td>
<td>88.06831</td>
<td>"cmn"</td>
</tr>
<tr class="odd">
<td>"IND"</td>
<td>"India"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>1463.866</td>
<td>72.4</td>
<td>22.8</td>
<td>83.0</td>
<td>0.685</td>
<td>10608</td>
<td>35.7</td>
<td>46.76</td>
<td>60.5</td>
<td>63.83039</td>
<td>"eng|hin"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are several important things to note in this code. First, the code is wrapped in a pair of parentheses, each on its own line, and all other lines are indented by four spaces. Second, we place the dataset on its own line and then call the <code>sort</code> method on the following line. Third, we use the <code>c.</code> prefix followed by the column name to refer to a column. Finally, the results are printed by default, but the original dataset is not modified. After running this code, the <code>country</code> column still has its original order. All of these features are shared across the entire set of DataFrame methods.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Selecting columns
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The standard way to specify columns in the functions in this chapter is the <code>c.</code> format. You can also specify a column using <code>c("&lt;str&gt;")</code>, where <code>&lt;str&gt;</code> is the column name. This is useful when the column name contains spaces or special characters and cannot be represented using dot notation. Some functions, such as <code>sort</code>, also allow specifying the column name directly in quotes without referencing <code>c</code>. We will avoid this in our code, but you may encounter it in other sources.</p>
</div>
</div>
</div>
<p>You can reverse the sorting order of <code>sort</code> by setting its <code>descending</code> parameter to <code>True</code>.</p>
<div id="f60004fb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.pop, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"IND"</td>
<td>"India"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>1463.866</td>
<td>72.4</td>
<td>22.8</td>
<td>83.0</td>
<td>0.685</td>
<td>10608</td>
<td>35.7</td>
<td>46.76</td>
<td>60.5</td>
<td>63.83039</td>
<td>"eng|hin"</td>
</tr>
<tr class="even">
<td>"CHN"</td>
<td>"China"</td>
<td>"Asia"</td>
<td>"Eastern Asia"</td>
<td>1416.096</td>
<td>78.81</td>
<td>35.844722</td>
<td>103.451944</td>
<td>0.797</td>
<td>25505</td>
<td>38.2</td>
<td>61.45</td>
<td>63.6</td>
<td>88.06831</td>
<td>"cmn"</td>
</tr>
<tr class="odd">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>"IDN"</td>
<td>"Indonesia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>285.721</td>
<td>72.25</td>
<td>-2.0</td>
<td>118.0</td>
<td>0.728</td>
<td>15391</td>
<td>37.9</td>
<td>56.95</td>
<td>85.8</td>
<td>77.51606</td>
<td>"ind"</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
<td>"eng|urd"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"COM"</td>
<td>"Comoros"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>0.883</td>
<td>70.26</td>
<td>-12.3</td>
<td>43.7</td>
<td>0.603</td>
<td>3718</td>
<td>45.3</td>
<td>35.88</td>
<td>25.2</td>
<td>35.85662</td>
<td>"ara|fra"</td>
</tr>
<tr class="even">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
<td>"fra|deu|ltz"</td>
</tr>
<tr class="odd">
<td>"MNE"</td>
<td>"Montenegro"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.633</td>
<td>76.92</td>
<td>42.766667</td>
<td>19.216667</td>
<td>0.862</td>
<td>29492</td>
<td>29.4</td>
<td>58.13</td>
<td>185.1</td>
<td>96.657</td>
<td>"cnr|cnr"</td>
</tr>
<tr class="even">
<td>"MLT"</td>
<td>"Malta"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.545</td>
<td>83.48</td>
<td>35.883333</td>
<td>14.5</td>
<td>0.924</td>
<td>63314</td>
<td>31.0</td>
<td>62.95</td>
<td>107.8</td>
<td>99.96455</td>
<td>"eng|mlt"</td>
</tr>
<tr class="odd">
<td>"ISL"</td>
<td>"Iceland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>0.398</td>
<td>84.92</td>
<td>65.0</td>
<td>-19.0</td>
<td>0.972</td>
<td>67444</td>
<td>26.1</td>
<td>75.62</td>
<td>107.2</td>
<td>98.78217</td>
<td>"isl"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now the countries with the highest population appear first. This descending order is often useful when we want to focus on the most extreme cases or identify outliers in our data. For example, the code below sorts by region (alphabetical order) and then, within each region, by population.</p>
<div id="73d0a235" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.region, c.pop)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"COM"</td>
<td>"Comoros"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>0.883</td>
<td>70.26</td>
<td>-12.3</td>
<td>43.7</td>
<td>0.603</td>
<td>3718</td>
<td>45.3</td>
<td>35.88</td>
<td>25.2</td>
<td>35.85662</td>
<td>"ara|fra"</td>
</tr>
<tr class="even">
<td>"MUS"</td>
<td>"Mauritius"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>1.268</td>
<td>76.35</td>
<td>-20.2</td>
<td>57.5</td>
<td>0.806</td>
<td>28927</td>
<td>36.8</td>
<td>57.59</td>
<td>92.8</td>
<td>95.45876</td>
<td>"eng|fra"</td>
</tr>
<tr class="odd">
<td>"BWA"</td>
<td>"Botswana"</td>
<td>"Africa"</td>
<td>"Southern Africa"</td>
<td>2.562</td>
<td>63.08</td>
<td>-22.2</td>
<td>23.7</td>
<td>0.731</td>
<td>18189</td>
<td>53.3</td>
<td>33.32</td>
<td>116.2</td>
<td>77.26922</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>"GAB"</td>
<td>"Gabon"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>2.593</td>
<td>68.68</td>
<td>-0.683331</td>
<td>11.5</td>
<td>0.733</td>
<td>19543</td>
<td>38.0</td>
<td>51.04</td>
<td>93.6</td>
<td>49.20331</td>
<td>"fra"</td>
</tr>
<tr class="odd">
<td>"GMB"</td>
<td>"Gambia"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>2.822</td>
<td>68.16</td>
<td>13.5</td>
<td>-15.5</td>
<td>0.524</td>
<td>3199</td>
<td>null</td>
<td>46.91</td>
<td>76.7</td>
<td>46.90722</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"GBR"</td>
<td>"United Kingdom of Great Britai…</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>69.551</td>
<td>81.93</td>
<td>54.6</td>
<td>-2.0</td>
<td>0.946</td>
<td>53993</td>
<td>32.8</td>
<td>66.58</td>
<td>121.8</td>
<td>99.1103</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>"DEU"</td>
<td>"Germany"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>84.075</td>
<td>82.13</td>
<td>51.0</td>
<td>10.0</td>
<td>0.959</td>
<td>64355</td>
<td>31.7</td>
<td>67.92</td>
<td>109.4</td>
<td>99.22504</td>
<td>"deu"</td>
</tr>
<tr class="odd">
<td>"RUS"</td>
<td>"Russian Federation"</td>
<td>"Europe"</td>
<td>"Eastern Europe"</td>
<td>143.997</td>
<td>73.89</td>
<td>66.416667</td>
<td>94.25</td>
<td>0.832</td>
<td>40871</td>
<td>36.0</td>
<td>58.65</td>
<td>165.1</td>
<td>88.24222</td>
<td>"rus"</td>
</tr>
<tr class="even">
<td>"NZL"</td>
<td>"New Zealand"</td>
<td>"Oceania"</td>
<td>"Australia and New Zealand"</td>
<td>5.252</td>
<td>82.65</td>
<td>-41.2</td>
<td>174.0</td>
<td>0.938</td>
<td>49598</td>
<td>null</td>
<td>69.76</td>
<td>108.3</td>
<td>100.0</td>
<td>"eng|mri|nzs"</td>
</tr>
<tr class="odd">
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Oceania"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
<td>"asf"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finally, store a copy of the dataset in a named variable using the following code:</p>
<div id="750d48d0" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>country_saved <span class="op">=</span> (</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.region, c.pop)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After running the code, <code>country_saved</code> contains the reordered dataset, while <code>country</code> still contains the original data. The same format can be used to save the results from the other methods described in the sections below.</p>
</section>
<section id="selecting-columns-1" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="selecting-columns-1"><span class="header-section-number">2.4</span> Selecting Columns</h2>
<p>In some cases—particularly when a dataset grows large—you may want to select or reorder its columns. Use the <code>.select</code> method with the same <code>c.</code> notation to specify the columns to include.</p>
<div id="b97d3de5" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    .select(c.iso, c.lat, c.lon)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>14.366667</td>
<td>-14.283333</td>
</tr>
<tr class="even">
<td>"VEN"</td>
<td>8.0</td>
<td>-67.0</td>
</tr>
<tr class="odd">
<td>"FIN"</td>
<td>65.0</td>
<td>27.0</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>39.828175</td>
<td>-98.5795</td>
</tr>
<tr class="odd">
<td>"LKA"</td>
<td>7.0</td>
<td>81.0</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>41.0</td>
<td>20.0</td>
</tr>
<tr class="even">
<td>"MYS"</td>
<td>3.7805111</td>
<td>102.314362</td>
</tr>
<tr class="odd">
<td>"SLV"</td>
<td>13.668889</td>
<td>-88.866111</td>
</tr>
<tr class="even">
<td>"CYP"</td>
<td>35.0</td>
<td>33.0</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>30.0</td>
<td>71.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Selecting columns is something we will do frequently in this text to clarify which parts of the dataset we want you to examine. It is less important for most data science pipelines, but it is particularly useful when performing more complex transformations, such as those in <a href="04_combine.html" class="quarto-xref"><span>Chapter 4</span></a>.</p>
<p>There is a similar function, <code>.drop</code>, which lets us select columns to remove from the data. Dropping columns is useful when a dataset has many columns and you want to remove only a few.</p>
</section>
<section id="selecting-rows" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="selecting-rows"><span class="header-section-number">2.5</span> Selecting Rows</h2>
<p>Often, we want to take a subset of rows from a dataset for a particular analysis or visualization. There are several functions for doing this, depending on the selection criteria. The <code>.head()</code> method, for example, returns a specified number of rows from the top of the dataset. The example below selects the first four rows.</p>
<div id="973bf6ce" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    .head(n<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
<td>"pbp|fra|wol"</td>
</tr>
<tr class="even">
<td>"VEN"</td>
<td>"Venezuela, Bolivarian Republic…</td>
<td>"Americas"</td>
<td>"South America"</td>
<td>28.517</td>
<td>76.18</td>
<td>8.0</td>
<td>-67.0</td>
<td>0.709</td>
<td>8899</td>
<td>44.8</td>
<td>57.65</td>
<td>96.8</td>
<td>95.66913</td>
<td>"spa|vsl"</td>
</tr>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>"fin|swe"</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The method <code>.tail(n=&lt;int&gt;)</code> works the same way, except that it selects rows starting from the bottom of the table. The methods <code>.drop_nulls()</code> and <code>.drop_nans()</code> take no arguments and return only rows that contain no missing or invalid data values, respectively.</p>
<p>The <code>.sample</code> method randomly selects rows. You can specify the number of rows with <code>n=&lt;int&gt;</code> or a fraction with <code>fraction=&lt;float&gt;</code>. Below is an example that takes a random 20% sample of the dataset.</p>
<div id="cd37a39a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .sample(fraction<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (27, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"IRN"</td>
<td>"Iran, Islamic Republic of"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>92.418</td>
<td>79.07</td>
<td>32.0</td>
<td>53.0</td>
<td>0.799</td>
<td>16540</td>
<td>40.9</td>
<td>50.04</td>
<td>69.8</td>
<td>89.31666</td>
<td>"fas"</td>
</tr>
<tr class="even">
<td>"COG"</td>
<td>"Congo"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>6.484</td>
<td>66.38</td>
<td>-0.75</td>
<td>15.383331</td>
<td>0.649</td>
<td>6377</td>
<td>48.9</td>
<td>49.54</td>
<td>83.3</td>
<td>20.17288</td>
<td>"fra"</td>
</tr>
<tr class="odd">
<td>"SGP"</td>
<td>"Singapore"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>5.871</td>
<td>85.63</td>
<td>1.3</td>
<td>103.8</td>
<td>0.946</td>
<td>137906</td>
<td>null</td>
<td>66.54</td>
<td>145.5</td>
<td>100.0</td>
<td>"eng|msa|cmn|tam"</td>
</tr>
<tr class="even">
<td>"POL"</td>
<td>"Poland"</td>
<td>"Europe"</td>
<td>"Eastern Europe"</td>
<td>38.141</td>
<td>79.1</td>
<td>52.0</td>
<td>19.0</td>
<td>0.906</td>
<td>47892</td>
<td>30.2</td>
<td>66.85</td>
<td>123.2</td>
<td>98.79661</td>
<td>"pol"</td>
</tr>
<tr class="odd">
<td>"AUT"</td>
<td>"Austria"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>9.114</td>
<td>83.17</td>
<td>48.0</td>
<td>14.0</td>
<td>0.93</td>
<td>64665</td>
<td>30.2</td>
<td>66.36</td>
<td>146.3</td>
<td>99.97291</td>
<td>"asq|deu"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"MUS"</td>
<td>"Mauritius"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>1.268</td>
<td>76.35</td>
<td>-20.2</td>
<td>57.5</td>
<td>0.806</td>
<td>28927</td>
<td>36.8</td>
<td>57.59</td>
<td>92.8</td>
<td>95.45876</td>
<td>"eng|fra"</td>
</tr>
<tr class="even">
<td>"NIC"</td>
<td>"Nicaragua"</td>
<td>"Americas"</td>
<td>"Central America"</td>
<td>7.008</td>
<td>76.51</td>
<td>13.0</td>
<td>-85.0</td>
<td>0.706</td>
<td>8023</td>
<td>46.2</td>
<td>63.62</td>
<td>69.1</td>
<td>72.87482</td>
<td>"spa"</td>
</tr>
<tr class="odd">
<td>"CHL"</td>
<td>"Chile"</td>
<td>"Americas"</td>
<td>"South America"</td>
<td>19.86</td>
<td>81.39</td>
<td>-33.0</td>
<td>-71.0</td>
<td>0.878</td>
<td>31425</td>
<td>44.9</td>
<td>62.3</td>
<td>115.5</td>
<td>100.0</td>
<td>"spa"</td>
</tr>
<tr class="even">
<td>"MEX"</td>
<td>"Mexico"</td>
<td>"Americas"</td>
<td>"Central America"</td>
<td>131.947</td>
<td>76.88</td>
<td>23.0</td>
<td>-102.0</td>
<td>0.789</td>
<td>22375</td>
<td>45.4</td>
<td>70.06</td>
<td>80.4</td>
<td>89.53789</td>
<td>"spa|yua"</td>
</tr>
<tr class="odd">
<td>"JPN"</td>
<td>"Japan"</td>
<td>"Asia"</td>
<td>"Eastern Asia"</td>
<td>123.103</td>
<td>85.58</td>
<td>35.0</td>
<td>136.0</td>
<td>0.925</td>
<td>47815</td>
<td>32.9</td>
<td>59.1</td>
<td>96.2</td>
<td>99.95242</td>
<td>"jpn"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can select rows that meet a condition defined by the dataset’s variables using the <code>.filter()</code> method. Similar to the <code>sort()</code> method, we use the syntax <code>c.</code> followed by variable names to define relationships between variables. Below is code that selects only the rows where the Human Development Index (HDI) is greater than 0.9.</p>
<div id="991946ed" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.hdi <span class="op">&gt;</span> <span class="fl">0.9</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (32, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>"fin|swe"</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
</tr>
<tr class="odd">
<td>"SGP"</td>
<td>"Singapore"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>5.871</td>
<td>85.63</td>
<td>1.3</td>
<td>103.8</td>
<td>0.946</td>
<td>137906</td>
<td>null</td>
<td>66.54</td>
<td>145.5</td>
<td>100.0</td>
<td>"eng|msa|cmn|tam"</td>
</tr>
<tr class="even">
<td>"AUT"</td>
<td>"Austria"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>9.114</td>
<td>83.17</td>
<td>48.0</td>
<td>14.0</td>
<td>0.93</td>
<td>64665</td>
<td>30.2</td>
<td>66.36</td>
<td>146.3</td>
<td>99.97291</td>
<td>"asq|deu"</td>
</tr>
<tr class="odd">
<td>"DEU"</td>
<td>"Germany"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>84.075</td>
<td>82.13</td>
<td>51.0</td>
<td>10.0</td>
<td>0.959</td>
<td>64355</td>
<td>31.7</td>
<td>67.92</td>
<td>109.4</td>
<td>99.22504</td>
<td>"deu"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"NLD"</td>
<td>"Netherlands, Kingdom of the"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>18.347</td>
<td>82.55</td>
<td>52.366667</td>
<td>4.883333</td>
<td>0.955</td>
<td>73384</td>
<td>null</td>
<td>72.55</td>
<td>114.4</td>
<td>97.71353</td>
<td>"nld"</td>
</tr>
<tr class="even">
<td>"IRL"</td>
<td>"Ireland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.308</td>
<td>82.94</td>
<td>53.0</td>
<td>-8.0</td>
<td>0.949</td>
<td>119406</td>
<td>null</td>
<td>68.17</td>
<td>103.1</td>
<td>89.3966</td>
<td>"eng|gle"</td>
</tr>
<tr class="odd">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
<td>"fra|deu|ltz"</td>
</tr>
<tr class="even">
<td>"CAN"</td>
<td>"Canada"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>40.127</td>
<td>83.15</td>
<td>56.0</td>
<td>-109.0</td>
<td>0.939</td>
<td>58422</td>
<td>33.3</td>
<td>68.41</td>
<td>75.5</td>
<td>98.92568</td>
<td>"eng|fra"</td>
</tr>
<tr class="odd">
<td>"CYP"</td>
<td>"Cyprus"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>1.371</td>
<td>81.77</td>
<td>35.0</td>
<td>33.0</td>
<td>0.913</td>
<td>55720</td>
<td>31.2</td>
<td>60.71</td>
<td>123.1</td>
<td>99.41781</td>
<td>"ell|tur"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can also filter categorical variables using equality comparisons. To prevent the page from becoming too cluttered, we will avoid printing this and some other results in future examples.</p>
<div id="5d23ba99" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.region <span class="op">==</span> <span class="st">"Europe"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This selects all countries in Europe. Note that we use the double-equals operator (<code>==</code>) to test equality; a single equals sign (<code>=</code>) is used only for assignment. The resulting dataset contains only rows where <code>region == "Europe"</code>.</p>
<p>Often, we want to apply multiple conditions simultaneously. We can combine conditions using the <code>&amp;</code> (and) and <code>|</code> (or) operators. When using these operators, wrap each condition in parentheses:</p>
<div id="c2f08a5f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>((c.region <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">&amp;</span> (c.hdi <span class="op">&gt;</span> <span class="fl">0.9</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sometimes we want to know whether a value belongs to a larger set. We can do this with the <code>.is_in</code> method, as shown in the following code. Note that the collection of elements passed to <code>.is_in</code> must be enclosed in square brackets. A detailed explanation of the object being created is provided in <a href="06_program.html" class="quarto-xref"><span>Chapter 6</span></a>.</p>
<div id="6a22188e" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.region.is_in([<span class="st">"Europe"</span>, <span class="st">"Africa"</span>]))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (75, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
<td>"pbp|fra|wol"</td>
</tr>
<tr class="even">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>"fin|swe"</td>
</tr>
<tr class="odd">
<td>"GAB"</td>
<td>"Gabon"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>2.593</td>
<td>68.68</td>
<td>-0.683331</td>
<td>11.5</td>
<td>0.733</td>
<td>19543</td>
<td>38.0</td>
<td>51.04</td>
<td>93.6</td>
<td>49.20331</td>
<td>"fra"</td>
</tr>
<tr class="even">
<td>"BGR"</td>
<td>"Bulgaria"</td>
<td>"Europe"</td>
<td>"Eastern Europe"</td>
<td>6.715</td>
<td>74.33</td>
<td>42.75</td>
<td>25.5</td>
<td>0.845</td>
<td>36211</td>
<td>40.3</td>
<td>55.9</td>
<td>137.1</td>
<td>86.00395</td>
<td>"bul"</td>
</tr>
<tr class="odd">
<td>"TZA"</td>
<td>"Tanzania, United Republic of"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>70.546</td>
<td>68.59</td>
<td>-6.306944</td>
<td>34.853889</td>
<td>0.555</td>
<td>3924</td>
<td>40.5</td>
<td>40.42</td>
<td>46.9</td>
<td>26.78297</td>
<td>"eng|swa"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
<td>"fra|deu|ltz"</td>
</tr>
<tr class="even">
<td>"LTU"</td>
<td>"Lithuania"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>2.83</td>
<td>77.19</td>
<td>55.2</td>
<td>24.0</td>
<td>0.895</td>
<td>49761</td>
<td>35.3</td>
<td>65.53</td>
<td>157.9</td>
<td>92.73568</td>
<td>"lit"</td>
</tr>
<tr class="odd">
<td>"MNE"</td>
<td>"Montenegro"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.633</td>
<td>76.92</td>
<td>42.766667</td>
<td>19.216667</td>
<td>0.862</td>
<td>29492</td>
<td>29.4</td>
<td>58.13</td>
<td>185.1</td>
<td>96.657</td>
<td>"cnr|cnr"</td>
</tr>
<tr class="even">
<td>"GMB"</td>
<td>"Gambia"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>2.822</td>
<td>68.16</td>
<td>13.5</td>
<td>-15.5</td>
<td>0.524</td>
<td>3199</td>
<td>null</td>
<td>46.91</td>
<td>76.7</td>
<td>46.90722</td>
<td>"eng"</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
<td>"sqi"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These operators, including <code>!=</code> (not equal) and <code>&gt;=</code> (greater than or equal to), allow us to select rows based on nearly any relationship in the dataset required for our analysis.</p>
</section>
<section id="grouping-data" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="grouping-data"><span class="header-section-number">2.6</span> Grouping Data</h2>
<p>There is a special method called <code>.group_by(...)</code> that allows you to group a dataset by one or more variables using a syntax similar to <code>.sort(...)</code>. When used in a method chain, the next method is applied separately to each group of rows that share the same value(s) for the grouping variable(s). For example, the following code selects the first country from each region in the dataset.</p>
<div id="63a0696b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    .head(n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Oceania"</td>
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
<td>"asf"</td>
</tr>
<tr class="even">
<td>"Asia"</td>
<td>"LKA"</td>
<td>"Sri Lanka"</td>
<td>"Southern Asia"</td>
<td>23.229</td>
<td>78.51</td>
<td>7.0</td>
<td>81.0</td>
<td>0.776</td>
<td>14380</td>
<td>39.3</td>
<td>36.02</td>
<td>83.1</td>
<td>90.77437</td>
<td>"sin|sin|tam|tam"</td>
</tr>
<tr class="odd">
<td>"Europe"</td>
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>"fin|swe"</td>
</tr>
<tr class="even">
<td>"Americas"</td>
<td>"VEN"</td>
<td>"Venezuela, Bolivarian Republic…</td>
<td>"South America"</td>
<td>28.517</td>
<td>76.18</td>
<td>8.0</td>
<td>-67.0</td>
<td>0.709</td>
<td>8899</td>
<td>44.8</td>
<td>57.65</td>
<td>96.8</td>
<td>95.66913</td>
<td>"spa|vsl"</td>
</tr>
<tr class="odd">
<td>"Africa"</td>
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
<td>"pbp|fra|wol"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This can be useful for various types of analysis. For example, we can determine the largest countries by population in each region using the following code:</p>
<div id="ba65dfbd" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.pop, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    .head(n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Oceania"</td>
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
<td>"asf"</td>
</tr>
<tr class="even">
<td>"Europe"</td>
<td>"RUS"</td>
<td>"Russian Federation"</td>
<td>"Eastern Europe"</td>
<td>143.997</td>
<td>73.89</td>
<td>66.416667</td>
<td>94.25</td>
<td>0.832</td>
<td>40871</td>
<td>36.0</td>
<td>58.65</td>
<td>165.1</td>
<td>88.24222</td>
<td>"rus"</td>
</tr>
<tr class="odd">
<td>"Americas"</td>
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
</tr>
<tr class="even">
<td>"Asia"</td>
<td>"IND"</td>
<td>"India"</td>
<td>"Southern Asia"</td>
<td>1463.866</td>
<td>72.4</td>
<td>22.8</td>
<td>83.0</td>
<td>0.685</td>
<td>10608</td>
<td>35.7</td>
<td>46.76</td>
<td>60.5</td>
<td>63.83039</td>
<td>"eng|hin"</td>
</tr>
<tr class="odd">
<td>"Africa"</td>
<td>"NGA"</td>
<td>"Nigeria"</td>
<td>"Western Africa"</td>
<td>237.528</td>
<td>66.07</td>
<td>9.0</td>
<td>8.0</td>
<td>0.56</td>
<td>5848</td>
<td>35.1</td>
<td>48.69</td>
<td>52.4</td>
<td>41.19972</td>
<td>"eng"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The following sections describe additional methods that can operate on grouped datasets.</p>
</section>
<section id="adding-columns" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="adding-columns"><span class="header-section-number">2.7</span> Adding Columns</h2>
<p>Creating or modifying columns in a dataset is a fundamental operation in data analysis. Analysts often need to compute new variables from existing data, create indicator (dummy) variables, or transform variables for analysis.</p>
<p>The basic pattern for adding a new column is to use the <code>.with_columns()</code> method. In the method call, specify the values you want to create or modify and define them in terms of existing columns. For example, the following multiplies the <code>population</code> column (values in millions) by 1,000 to obtain the population in thousands.</p>
<div id="b7d29584" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(population_1k <span class="op">=</span> c.pop <span class="op">*</span> <span class="dv">1000</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 16)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
<th data-quarto-table-cell-role="th">population_1k</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
<td>"pbp|fra|wol"</td>
<td>18932.0</td>
</tr>
<tr class="even">
<td>"VEN"</td>
<td>"Venezuela, Bolivarian Republic…</td>
<td>"Americas"</td>
<td>"South America"</td>
<td>28.517</td>
<td>76.18</td>
<td>8.0</td>
<td>-67.0</td>
<td>0.709</td>
<td>8899</td>
<td>44.8</td>
<td>57.65</td>
<td>96.8</td>
<td>95.66913</td>
<td>"spa|vsl"</td>
<td>28517.0</td>
</tr>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>"fin|swe"</td>
<td>5623.0</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
<td>347276.0</td>
</tr>
<tr class="odd">
<td>"LKA"</td>
<td>"Sri Lanka"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>23.229</td>
<td>78.51</td>
<td>7.0</td>
<td>81.0</td>
<td>0.776</td>
<td>14380</td>
<td>39.3</td>
<td>36.02</td>
<td>83.1</td>
<td>90.77437</td>
<td>"sin|sin|tam|tam"</td>
<td>23229.0</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
<td>"sqi"</td>
<td>2772.0</td>
</tr>
<tr class="even">
<td>"MYS"</td>
<td>"Malaysia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>35.978</td>
<td>76.03</td>
<td>3.7805111</td>
<td>102.314362</td>
<td>0.819</td>
<td>35990</td>
<td>46.2</td>
<td>58.68</td>
<td>118.2</td>
<td>95.69194</td>
<td>"msa"</td>
<td>35978.0</td>
</tr>
<tr class="odd">
<td>"SLV"</td>
<td>"El Salvador"</td>
<td>"Americas"</td>
<td>"Central America"</td>
<td>6.366</td>
<td>76.98</td>
<td>13.668889</td>
<td>-88.866111</td>
<td>0.678</td>
<td>12221</td>
<td>38.3</td>
<td>64.82</td>
<td>126.9</td>
<td>86.19786</td>
<td>"spa"</td>
<td>6366.0</td>
</tr>
<tr class="even">
<td>"CYP"</td>
<td>"Cyprus"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>1.371</td>
<td>81.77</td>
<td>35.0</td>
<td>33.0</td>
<td>0.913</td>
<td>55720</td>
<td>31.2</td>
<td>60.71</td>
<td>123.1</td>
<td>99.41781</td>
<td>"ell|tur"</td>
<td>1371.0</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
<td>"eng|urd"</td>
<td>255220.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Common mathematical transformations of variables can be accessed by using a <code>.</code> after the variable name, followed by a transformation function such as <code>sqrt()</code> or <code>log10()</code>. The following example demonstrates the method: take the square root and the sine of <code>population</code>, and save each as a new column.</p>
<div id="6ab735ff" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      pop_sqrt <span class="op">=</span> c.pop.sqrt(),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      pop_sin <span class="op">=</span> c.pop.sin()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the format of the code above. When a column definition is long (or when defining multiple columns at once), put each definition on its own line and indent it by four spaces.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alias method
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Polars includes a method called <code>.alias</code> that can be used within <code>.with_columns</code> to create or overwrite a column in a dataset. It was originally the standard technique, but it has largely been replaced by the equals-sign method, which many people, including me, find more intuitive. It’s useful to understand only because you’ll often see it in the Polars documentation.</p>
</div>
</div>
</div>
</section>
<section id="aggregation" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="aggregation"><span class="header-section-number">2.8</span> Aggregation</h2>
<p>Although examining individual rows can be informative, we often need summary statistics to understand the overall patterns in our data. Polars provides powerful aggregation tools that let us compute statistics across rows within specific groups. The <code>.agg()</code> method (short for “aggregate”) is the primary tool for computing summary statistics. It allows us to specify exactly which statistics to compute and for which columns.</p>
<div id="e5f5a46b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      hdi_avg <span class="op">=</span> c.hdi.mean()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">hdi_avg</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Americas"</td>
<td>0.783579</td>
</tr>
<tr class="even">
<td>"Europe"</td>
<td>0.898895</td>
</tr>
<tr class="odd">
<td>"Oceania"</td>
<td>0.948</td>
</tr>
<tr class="even">
<td>"Africa"</td>
<td>0.583351</td>
</tr>
<tr class="odd">
<td>"Asia"</td>
<td>0.760897</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In this example, we compute the average HDI across countries within each region. The syntax uses <code>c.</code> followed by the column name, then the aggregation function with parentheses. Note that only the grouping variable(s) and the columns created by the <code>.agg()</code> function appear in the result.</p>
<p>We can compute multiple statistics at once by including additional items in our aggregation. It is often useful to include the special function <code>pl.len()</code>, which counts the number of rows in each group.</p>
<div id="fc7e030b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        hdi_avg <span class="op">=</span> c.hdi.mean(),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        hdi_median <span class="op">=</span> c.hdi.median(),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> pl.<span class="bu">len</span>()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">hdi_avg</th>
<th data-quarto-table-cell-role="th">hdi_median</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Asia"</td>
<td>0.760897</td>
<td>0.766</td>
<td>39</td>
</tr>
<tr class="even">
<td>"Europe"</td>
<td>0.898895</td>
<td>0.9115</td>
<td>38</td>
</tr>
<tr class="odd">
<td>"Americas"</td>
<td>0.783579</td>
<td>0.786</td>
<td>19</td>
</tr>
<tr class="even">
<td>"Africa"</td>
<td>0.583351</td>
<td>0.571</td>
<td>37</td>
</tr>
<tr class="odd">
<td>"Oceania"</td>
<td>0.948</td>
<td>0.948</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This operation computes the average density and the number of regions in each division of the United States. The result is a new DataFrame where each row represents a division and each column shows one of the computed statistics. This grouped analysis is essential for understanding how variables vary across categories in our data.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aggregating the entire DataFrame
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In some cases, we may want to perform one or more aggregation functions on an entire DataFrame. In Polars, it is not possible to apply the <code>.agg</code> method without first grouping the data (this is different from R or Pandas). Instead, use <code>.select</code> and the same syntax as <code>.agg</code> inside the function call. While using the column-selector function to perform aggregation may seem unusual, it makes sense given how Polars optimizes chains of data processing. The specific reason, however, is well beyond the scope of this text.</p>
</div>
</div>
</div>
<p>Polars provides a wide range of aggregation functions that can be used with the <code>.agg()</code> method. Here are some of the most commonly used functions:</p>
<ul>
<li><code>.mean()</code>, <code>.median()</code>, <code>.min()</code>, <code>.max()</code>, <code>.sum()</code>, <code>.quantile(&lt;f64&gt;)</code></li>
<li><code>.first()</code>, <code>.last()</code> - <code>.any()</code>, <code>.all()</code></li>
<li><code>.n_unique()</code>, <code>.count()</code>, <code>.len()</code></li>
<li><code>pl.corr(..., ...)</code> (correlation)</li>
<li><code>pl.concat_str(...)</code></li>
</ul>
<p>These cover most use cases in our analyses.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Counting observations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are three ways to count the number of observations in a group. We can use the <code>.len()</code> method applied to any column (it doesn’t matter which) to get the total number of rows, or use <code>.count()</code> on a column to get the number of non-missing values in that column. The special function <code>pl.len()</code> returns the same result as applying <code>.len()</code> to any column, but makes it clear that the result does not depend on which column we choose. For this reason, I prefer <code>pl.len()</code> unless I specifically want the number of non-missing values. There is also <code>.n_unique()</code> to find the number of unique non-missing values in a column.</p>
</div>
</div>
</div>
</section>
<section id="pipes" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="pipes"><span class="header-section-number">2.9</span> Pipes</h2>
<p>The syntax of chaining methods is very powerful. It makes our code more readable, avoids errors from naming intermediate values, and allows Polars to create internally optimized functions that chain the sequence of methods in the most efficient way. One possible roadblock to method chaining is that we only have access to methods built into Polars. To overcome this, Polars allows us to call an arbitrary function with the DataFrame as its first argument using the <code>.pipe</code> method. <code>.pipe</code> takes the function to apply as its first argument; additional arguments are passed on to the function.</p>
<p>As a simple example, we can apply the built-in Python function <code>type</code> to a DataFrame using the <code>.pipe</code> method to verify the object’s type. The output shows the full Python description of the DataFrame.</p>
<div id="239965f1" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    .pipe(<span class="bu">type</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>polars.dataframe.frame.DataFrame</code></pre>
</div>
</div>
<p>This will be particularly helpful in <a href="03_graphics.html" class="quarto-xref"><span>Chapter 3</span></a>, where we will use the <code>.pipe</code> method to pass a <code>DataFrame</code> to the <code>ggplot</code> function to create a data visualization directly within a chain of methods.</p>
</section>
<section id="further-functions" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="further-functions"><span class="header-section-number">2.10</span> Further Functions</h2>
<p>Let’s finish with a few additional functions that are useful inside the <code>with_columns</code> method. We can create new columns that depend on conditions in our existing data using the special function <code>pl.when</code>. The code below shows its use in creating a variable equal to 1 for countries in the Northern Hemisphere and 0 for those in the Southern Hemisphere.</p>
<div id="cb2e3245" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        is_north <span class="op">=</span> pl.when(c.lat <span class="op">&gt;=</span> <span class="dv">0</span>).then(<span class="dv">1</span>).otherwise(<span class="dv">0</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also access the next or previous values of a column using <code>shift(&lt;i64&gt;)</code>, where <code>&lt;i64&gt;</code> specifies the number of rows to shift: positive values access rows above, and negative values access rows below. For example, the code below shows the percentage by which each country is larger than the next-smallest country in the dataset.</p>
<div id="308ca136" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.pop, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        perc_larger <span class="op">=</span> c.pop <span class="op">/</span> c.pop.shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>.with_columns</code> method can compute values within a group, returning aggregations repeated for each row. However, it does not work with the <code>group_by()</code> function. Instead, use the <code>.over()</code> method on a specific column to indicate the grouping. For example, here we compute the percentage that each country occupies within its region.</p>
<div id="133b9152" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        pop_region <span class="op">=</span> c.pop <span class="op">/</span> c.pop.over(<span class="st">"region"</span>).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    .sort(c.pop_region, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 16)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">lang</th>
<th data-quarto-table-cell-role="th">pop_region</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"IND"</td>
<td>"India"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>1463.866</td>
<td>72.4</td>
<td>22.8</td>
<td>83.0</td>
<td>0.685</td>
<td>10608</td>
<td>35.7</td>
<td>46.76</td>
<td>60.5</td>
<td>63.83039</td>
<td>"eng|hin"</td>
<td>18.762505</td>
</tr>
<tr class="even">
<td>"CHN"</td>
<td>"China"</td>
<td>"Asia"</td>
<td>"Eastern Asia"</td>
<td>1416.096</td>
<td>78.81</td>
<td>35.844722</td>
<td>103.451944</td>
<td>0.797</td>
<td>25505</td>
<td>38.2</td>
<td>61.45</td>
<td>63.6</td>
<td>88.06831</td>
<td>"cmn"</td>
<td>18.150232</td>
</tr>
<tr class="odd">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>"eng"</td>
<td>4.451068</td>
</tr>
<tr class="even">
<td>"IDN"</td>
<td>"Indonesia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>285.721</td>
<td>72.25</td>
<td>-2.0</td>
<td>118.0</td>
<td>0.728</td>
<td>15391</td>
<td>37.9</td>
<td>56.95</td>
<td>85.8</td>
<td>77.51606</td>
<td>"ind"</td>
<td>3.662112</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
<td>"eng|urd"</td>
<td>3.271178</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"COM"</td>
<td>"Comoros"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>0.883</td>
<td>70.26</td>
<td>-12.3</td>
<td>43.7</td>
<td>0.603</td>
<td>3718</td>
<td>45.3</td>
<td>35.88</td>
<td>25.2</td>
<td>35.85662</td>
<td>"ara|fra"</td>
<td>0.011317</td>
</tr>
<tr class="even">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
<td>"fra|deu|ltz"</td>
<td>0.008716</td>
</tr>
<tr class="odd">
<td>"MNE"</td>
<td>"Montenegro"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.633</td>
<td>76.92</td>
<td>42.766667</td>
<td>19.216667</td>
<td>0.862</td>
<td>29492</td>
<td>29.4</td>
<td>58.13</td>
<td>185.1</td>
<td>96.657</td>
<td>"cnr|cnr"</td>
<td>0.008113</td>
</tr>
<tr class="even">
<td>"MLT"</td>
<td>"Malta"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.545</td>
<td>83.48</td>
<td>35.883333</td>
<td>14.5</td>
<td>0.924</td>
<td>63314</td>
<td>31.0</td>
<td>62.95</td>
<td>107.8</td>
<td>99.96455</td>
<td>"eng|mlt"</td>
<td>0.006985</td>
</tr>
<tr class="odd">
<td>"ISL"</td>
<td>"Iceland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>0.398</td>
<td>84.92</td>
<td>65.0</td>
<td>-19.0</td>
<td>0.972</td>
<td>67444</td>
<td>26.1</td>
<td>75.62</td>
<td>107.2</td>
<td>98.78217</td>
<td>"isl"</td>
<td>0.005101</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>.over()</code> and <code>.shift()</code> methods can also be used within <code>.filter()</code>.</p>
</section>
<section id="rs-dplyr-and-python-pandas" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="rs-dplyr-and-python-pandas"><span class="header-section-number">2.11</span> R’s dplyr and Python Pandas</h2>
<p>If you’re familiar with <code>dplyr</code> in R or <code>pandas</code> in Python, the code in this chapter should feel familiar. Specific function names differ, and each library has its own quirks. Ultimately, the important thing is to understand how to compose the methods above to transform data flexibly into the format you need for a particular application.</p>
<p>If you’re coming from dplyr, the main differences are prefixing column names with <code>c.</code>, using methods instead of pipes (the same idea, different syntax), and using methods in place of aggregate functions. Some methods are renamed—for example, <code>agg</code> replaces <code>summarize</code> and <code>sort</code> replaces <code>arrange</code>—but they otherwise behave similarly.</p>
<p>Transitioning from Pandas requires a few more changes, but most are designed to make the code simpler and more consistent. We no longer have an index column that needs to be reset after every aggregation. Nor do we have aggregation functions wrapped in complex tuples or the <code>eval</code> and <code>query</code> methods buried inside an extra layer of quotes.</p>
<p>As with Pandas and dplyr, Polars also provides functions for pivots and table joins. We will see those in <a href="04_combine.html" class="quarto-xref"><span>Chapter 4</span></a>. Although some arguments have different names across the three libraries, the differences in these transformations are relatively minor.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/taylor-arnold\.github\.io\/fds-py");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_graphics.html" class="pagination-link" aria-label="EDA II: Visualizing Data">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">EDA II: Visualizing Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Taylor Arnold</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>A <a href="https://distantviewing.org/">Distant Viewing Lab</a> project</p>
</div>
  </div>
</footer>




</body></html>